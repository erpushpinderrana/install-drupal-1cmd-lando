name: d8
recipe: drupal8
config:
  webroot: web

services:
  # This is the service that contains your application's code.
  appserver:
    build:
      # Run "composer install" automatically during build.
      - composer install

  # PhpMyAdmin
  pma:
    type: phpmyadmin
    hosts:
      - database
      - drupal8

  # Drupal 8 database
  drupal8:
    type: mysql
    creds:
      user: drupal8
      password: drupal8
      database: drupal8     
events:
  post-rebuild:
    - appserver: /app/scripts/install.sh

  post-destroy:
    - rm -rfv web
    - rm -rfv vendor

  pre-rebuild:
    - rm -rfv web
    - rm -rfv vendor
